<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Estimation · MomentMatching.jl</title><meta name="title" content="Estimation · MomentMatching.jl"/><meta property="og:title" content="Estimation · MomentMatching.jl"/><meta property="twitter:title" content="Estimation · MomentMatching.jl"/><meta name="description" content="Documentation for MomentMatching.jl."/><meta property="og:description" content="Documentation for MomentMatching.jl."/><meta property="twitter:description" content="Documentation for MomentMatching.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="MomentMatching.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MomentMatching.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../examples/">Example</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ZoltanRacz/MomentMatching.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ZoltanRacz/MomentMatching.jl/blob/main/docs/src/fragments/estimation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Estimation"><a class="docs-heading-anchor" href="#Estimation">Estimation</a><a id="Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Estimation" title="Permalink"></a></h1><h2 id="Model-setup"><a class="docs-heading-anchor" href="#Model-setup">Model setup</a><a id="Model-setup-1"></a><a class="docs-heading-anchor-permalink" href="#Model-setup" title="Permalink"></a></h2><p>The first step of the estimation routine is for the user to define her own model type through:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MomentMatching.EstimationSetup" href="#MomentMatching.EstimationSetup"><code>MomentMatching.EstimationSetup</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct EstimationSetup{U&lt;:EstimationMode}</code></pre><p><strong>Description</strong></p><p>Structure to store setup of matching moments estimation procedure.</p><p><strong>Fields</strong></p><ul><li><p><code>mode</code>: Estimation mode.</p></li><li><p><code>modelname</code>: Submethod for estimation. String encoding which parameters and how are estimated.</p></li><li><p><code>typemom</code>: Submethod for estimation. String encoding which moments are targeted.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ZoltanRacz/MomentMatching.jl/blob/74e6b0fb8d4a2661aabd8f66a3fea48389954216/src/estimation.jl#L29">source</a></section></article><p>For instance, running:</p><pre><code class="nohighlight hljs"></code></pre><p>defines an EstimationSetup type with mode called Model1, modelname called benchmark and typemom set1.</p><p>Once EstimationSetup has been defined, </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MomentMatching.AuxiliaryParameters" href="#MomentMatching.AuxiliaryParameters"><code>MomentMatching.AuxiliaryParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">abstract type AuxiliaryParameters</code></pre><p><strong>Description</strong></p><p>Supplies non-estimated auxuliary parameters, which are needed to compute model moments for any guess of the estimated parameters. Assumed to be non-random and constant over the estimation procedure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ZoltanRacz/MomentMatching.jl/blob/74e6b0fb8d4a2661aabd8f66a3fea48389954216/src/estimation.jl#L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MomentMatching.PredrawnShocks" href="#MomentMatching.PredrawnShocks"><code>MomentMatching.PredrawnShocks</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">abstract type PredrawnShocks</code></pre><p><strong>Description</strong></p><p>Supplies pre-drawn shocks, which are needed to compute model moments for any guess of the estimated parameters. Assumed to be random, but constant over the estimation procedure (so that the minimization procedure works well). They are however re-simulated when performing bootstrap.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ZoltanRacz/MomentMatching.jl/blob/74e6b0fb8d4a2661aabd8f66a3fea48389954216/src/estimation.jl#L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MomentMatching.PreallocatedContainers" href="#MomentMatching.PreallocatedContainers"><code>MomentMatching.PreallocatedContainers</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">abstract type PreallocatedContainers</code></pre><p><strong>Description</strong></p><p>Supplies empty arrays for computations to calculate model moments as few memory allocations as possible.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ZoltanRacz/MomentMatching.jl/blob/74e6b0fb8d4a2661aabd8f66a3fea48389954216/src/estimation.jl#L83">source</a></section></article><p>%<code>@docs %NumParMM %</code></p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MomentMatching.ParMM" href="#MomentMatching.ParMM"><code>MomentMatching.ParMM</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct ParMM{S&lt;:AbstractFloat}</code></pre><p><strong>Description</strong></p><p>Structure to store matching moments estimation inputs.</p><p><strong>Fields</strong></p><ul><li><p><code>lb_global</code>: Lower bound for parameters in global stage</p></li><li><p><code>ub_global</code>: Upper bound for parameters in global stage</p></li><li><p><code>lb_hard</code>: Hard lower bound for parameters - being outside brings penalty in local stage</p></li><li><p><code>ub_hard</code>: Hard upper bound for parameters - being outside brings penalty in local stage</p></li><li><p><code>labels</code>: Labels of estimated parameters</p></li><li><p><code>momdat</code>: Moments from the data to match</p></li><li><p><code>mmomdat</code>: Normalizing factor moments from the data to match</p></li><li><p><code>W</code>: Weighting matrix</p></li><li><p><code>mdifrec</code>: Predetermined quantity to re-center moment condition</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ZoltanRacz/MomentMatching.jl/blob/74e6b0fb8d4a2661aabd8f66a3fea48389954216/src/estimation.jl#L138">source</a></section></article><h2 id="Numerical-routines"><a class="docs-heading-anchor" href="#Numerical-routines">Numerical routines</a><a id="Numerical-routines-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-routines" title="Permalink"></a></h2><p>The main function to run the estimation routine is: </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MomentMatching.estimation" href="#MomentMatching.estimation"><code>MomentMatching.estimation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">estimation(estset::EstimationSetup;&lt;keyword arguments&gt;)</code></pre><p>Estimate model parameters given instance of <a href="#MomentMatching.EstimationSetup"><code>EstimationSetup</code></a>.</p><p>Can be customized if non-default estimation cases have to be performed. Accepts initial guess(es) when only local stage is performed.</p><p><strong>Keyword arguments</strong></p><ul><li><code>npmm::NumParMM=NumParMM(estset)</code>: numerical parameters for estimation.</li><li><code>cs::ComputationSettings=ComputationSettings()</code>: computational options.</li><li><code>aux::AuxiliaryParameters=AuxiliaryParameters(estset)</code>: any additional pre-determined (i.e., not to be estimated) model-specific parameters.</li><li><code>presh::PredrawnShocks=PredrawnShocks(estset, aux)</code>: pre-generated random shocks.</li><li><code>xlocstart=[[1.0]]::Vector{Vector{Float64}}</code>: starting point for local optimization when only local stage is performed.</li><li><code>saving::Bool=true</code>: whether to save the final estimation results.</li><li><code>saving_bestmodel::Bool=saving</code>: whether to save the results for the best parameters vectors.</li><li><code>number_bestmodel::Integer=1</code>: for how many best parameter vectors to save results.</li><li><code>filename_suffix::String=&quot;&quot;</code>: suffix to use in output filenames.</li><li><code>errorcatching::Bool=false</code>: if true the estimation routine does not stop if an error happens when computing moments for a given parameter vector guess.</li><li><code>vararg...</code>: additional arguments passed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ZoltanRacz/MomentMatching.jl/blob/74e6b0fb8d4a2661aabd8f66a3fea48389954216/src/estimation.jl#L226-L245">source</a></section></article><p>In addition to the model setup elements described above, the user can also define her preferred computational settings:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MomentMatching.ComputationSettings" href="#MomentMatching.ComputationSettings"><code>MomentMatching.ComputationSettings</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct ComputationSettings{T&lt;:Integer}</code></pre><p><strong>Description</strong></p><p>Computational settings for performing parallel computing either locally or on a cluster.</p><p><strong>Fields</strong></p><ul><li><p><code>location</code>: Where computation is performed. &#39;local&#39; and &#39;slurm&#39; are supported presently Default: local</p></li><li><p><code>num_procs</code>: Number of processes used by estimation and bootstrapping routines. Giving 1 avoids adding any new process. On Slurm cluster this has to be equal to :nodes * :ntasks<em>per</em>node Default: 1</p></li><li><p><code>num_tasks</code>: Number of tasks spawned per process in estimation and bootstrapping routines. Giving somewhat more than the number of actual threads is probably a good idea to avoid idleness. Setting it equal to one implies that only one thread per process will be used by functions in this package (even if more are present). Note that in this case multithreading within the internal function is possible as long that is written in a data-race free way. Default: Threads.nthreads() * 2</p></li><li><p><code>num_threads</code>: Number of threads to be used when starting each new process. Relevant only with multiprocessing. On Slurm cluster this has to be equal to :cpus<em>per</em>task Default: Int(floor(Threads.nthreads() / num_procs))</p></li><li><p><code>maxmem</code>: Trigger intensive garbage collection at this memory usage Default: -1</p></li><li><p><code>clustermanager_settings</code>: Other settings Default: Dict(:x =&gt; &quot;&quot;)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ZoltanRacz/MomentMatching.jl/blob/74e6b0fb8d4a2661aabd8f66a3fea48389954216/src/estimation.jl#L202">source</a></section></article><p>Furthermore, the user can decide:</p><ul><li>whether to save the final estimation results through <code>saving</code>;</li><li>whether to save the evaluated moments for the best (i.e., those returning the lowest objective function values) <code>number_bestmodel</code> points through <code>saving_bestmodel</code>;</li><li>whether to add a specific suffix to saved files via <code>filename_suffix</code>;</li><li>whether to proceed with the estimation routine until the end if evaluation of the objective function at a specific candidate point returns an error <code>errorcatching</code>.</li></ul><p>Additional model-specific arguments needed for model initialization can be passed through via <code>vararg...</code>.</p><p>Results of the estimation routine are stored in a dedicated structure:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MomentMatching.EstimationResult" href="#MomentMatching.EstimationResult"><code>MomentMatching.EstimationResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct EstimationResult{S&lt;:AbstractFloat, T&lt;:Integer, U&lt;:AuxiliaryParameters, V&lt;:PredrawnShocks}</code></pre><p><strong>Description</strong></p><p>Structure to store output of matching moments estimation procedure.</p><p><strong>Fields</strong></p><ul><li><p><code>npmm</code>: Numerical parameters</p></li><li><p><code>aux</code>: Auxiliary inputs</p></li><li><p><code>presh</code>: Predrawn shocks</p></li><li><p><code>xlocstart</code>: Starting parameters - relevant when only local stage is performed</p></li><li><p><code>pmm</code>: Moment estimation inputs</p></li><li><p><code>fglo</code>: Objective function value in global stage, sorted in increasing order</p></li><li><p><code>xglo</code>: Parameter combinations checked in global stage, sorted according to objective function value</p></li><li><p><code>momglo</code>: Moments from model, global stage</p></li><li><p><code>floc</code>: Objective function value in local stage, sorted in increasing order</p></li><li><p><code>xloc</code>: Parameter combinations checked in local stage, sorted according to objective function value</p></li><li><p><code>momloc</code>: Moments from model, local stage</p></li><li><p><code>conv</code>: Logical, if true convergence criterion at minimum is satisfied in the local stage</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ZoltanRacz/MomentMatching.jl/blob/74e6b0fb8d4a2661aabd8f66a3fea48389954216/src/estimation.jl#L168">source</a></section></article><h3 id="Global-stage"><a class="docs-heading-anchor" href="#Global-stage">Global stage</a><a id="Global-stage-1"></a><a class="docs-heading-anchor-permalink" href="#Global-stage" title="Permalink"></a></h3><h3 id="Local-stage"><a class="docs-heading-anchor" href="#Local-stage">Local stage</a><a id="Local-stage-1"></a><a class="docs-heading-anchor-permalink" href="#Local-stage" title="Permalink"></a></h3><h3 id="Comparison-with-other-algorithms"><a class="docs-heading-anchor" href="#Comparison-with-other-algorithms">Comparison with other algorithms</a><a id="Comparison-with-other-algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-with-other-algorithms" title="Permalink"></a></h3><h2 id="Multithreading-and-multiprocessing"><a class="docs-heading-anchor" href="#Multithreading-and-multiprocessing">Multithreading and multiprocessing</a><a id="Multithreading-and-multiprocessing-1"></a><a class="docs-heading-anchor-permalink" href="#Multithreading-and-multiprocessing" title="Permalink"></a></h2><h3 id="Locally"><a class="docs-heading-anchor" href="#Locally">Locally</a><a id="Locally-1"></a><a class="docs-heading-anchor-permalink" href="#Locally" title="Permalink"></a></h3><h3 id="Cluster"><a class="docs-heading-anchor" href="#Cluster">Cluster</a><a id="Cluster-1"></a><a class="docs-heading-anchor-permalink" href="#Cluster" title="Permalink"></a></h3><h2 id="Two-step-estimation"><a class="docs-heading-anchor" href="#Two-step-estimation">Two-step estimation</a><a id="Two-step-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Two-step-estimation" title="Permalink"></a></h2></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 8 August 2025 07:46">Friday 8 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
